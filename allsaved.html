<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8">
  <title>All Saved Configurations</title>
</head>
<body style="font-family:'Inter',sans-serif;margin:0;padding:0;display:flex;justify-content:center;min-height:100vh;">
  <div style="width:900px;margin-top:40px;background:white;border-radius:16px;box-shadow:0 10px 25px rgba(0,0,0,0.2);overflow:hidden;">
    
    <!-- Header -->
    <div style="position:relative;background:url('https://d37ec3di8bduyh.cloudfront.net/portal/default/img/header.svg') center/cover no-repeat;height:70px;display:flex;align-items:center;background-color:#237803;justify-content:flex-start;padding-left:24px;">
      <img src="https://s3.eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/76042127662/logo/kAvkfKrV4ZdEZZ0skKSgxq0Y_Ea1w9bI5Q.png" 
           alt="Header Logo" 
           style="height:40px;object-fit:contain;">
    </div>

    <div style="display:flex;justify-content:space-between;align-items:center;padding:16px 24px 0;">
      <h2 style="color:#237803;margin:0;">All Saved Configurations</h2>
      <a href="index.html" 
         style="background:#237803;color:white;padding:8px 16px;border-radius:6px;text-decoration:none;font-weight:500;">
         âž• Add New
      </a>
    </div>

 <table id="savedTable" style="width:100%;margin-top:20px;border-collapse:collapse;">
  <thead>
    <tr style="background:#f1f5f9;color:#374151;">
      <th style="border:1px solid #d1d5db;padding:8px;">ID</th>
      <th style="border:1px solid #d1d5db;padding:8px;">Shop</th>
      <th style="border:1px solid #d1d5db;padding:8px;">Products</th>
      <th style="border:1px solid #d1d5db;padding:8px;">Actions</th>
    </tr>
  </thead>
  <tbody id="tableBody"></tbody>
</table>

<script>
const tableBody = document.getElementById('tableBody');

// Example structure with multiple shops for same ID
const sampleData = [
  {
    id: "1",
    shops: [
      { name: "zooplus.de", products: ["11","122"] },
      { name: "zooplus.com", products: ["22","33"] }
    ]
  },
  {
    id: "2",
    shops: [
      { name: "shop2.com", products: ["5","6"] }
    ]
  }
];

let data = JSON.parse(localStorage.getItem('savedConfigs1') || 'null');
if (!data || data.length === 0) {
  data = sampleData;
  localStorage.setItem('savedConfigs1', JSON.stringify(data));
}

function renderTable() {
  tableBody.innerHTML = '';

  data.forEach((config, index) => {
    const shops = config.shops;
    shops.forEach((shop, shopIndex) => {
      const row = document.createElement('tr');

      // Only show ID and Actions in first row, use rowspan for multiple shops
      row.innerHTML = `
        ${shopIndex === 0 ? `<td style="border:1px solid #d1d5db;padding:8px;vertical-align:top;" rowspan="${shops.length}">${config.id}</td>` : ''}
        <td style="border:1px solid #d1d5db;padding:8px;">${shop.name}</td>
        <td style="border:1px solid #d1d5db;padding:8px;">${shop.products.join(', ')}</td>
        ${shopIndex === 0 ? `<td style="border:1px solid #d1d5db;padding:8px;text-align:center;vertical-align:top;" rowspan="${shops.length}">
          <button onclick="" style="background:#237803;color:white;padding:6px 10px;border:none;border-radius:4px;cursor:pointer;">Edit</button>
          <button onclick="" style="background:#237803;color:white;padding:6px 10px;border:none;border-radius:4px;cursor:pointer;margin-left:6px;">Delete</button>
        </td>` : ''}
      `;

      tableBody.appendChild(row);
    });
  });
}

function editConfig(index) {
  const config = data[index];
  config.shops.forEach((shop, i) => {
    const newProducts = prompt(`Edit products for ${shop.name} (comma-separated):`, shop.products.join(','));
    if (newProducts !== null) {
      config.shops[i].products = newProducts.split(',').map(p => p.trim()).filter(Boolean);
    }
  });
  localStorage.setItem('savedConfigs1', JSON.stringify(data));
  renderTable();
}

function deleteConfig(index) {
  if (confirm("Delete this configuration?")) {
    data.splice(index, 1);
    localStorage.setItem('savedConfigs1', JSON.stringify(data));
    renderTable();
  }
}

renderTable();
</script>

</body>
</html>
